// data/regulationsData.js
// Consolidated Ontario Regulations Data

export const regulationsData = [
  // Ontario Regulation 211/01 - Propane Storage and Handling
  {
    id: "211-01-1",
    regulation: "Ontario Regulation 211/01",
    section: "1",
    title: "Interpretation",
    description: "Definitions including appliance, approved, certificate, code adoption document, contractor, distributor, and propane facility terms.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "interpretation definitions appliance approved certificate code adoption document contractor distributor facility"
  },
  {
    id: "211-01-2",
    regulation: "Ontario Regulation 211/01",
    section: "2",
    title: "Application",
    description: "Applies to storage, handling, transportation and transfer of propane, installation of appliances on vehicles and recreational vehicles, and conversion of vehicles to propane.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "application scope storage handling transportation transfer propane installation appliances vehicles conversion"
  },
  {
    id: "211-01-3",
    regulation: "Ontario Regulation 211/01",
    section: "3",
    title: "General requirement for compliance",
    description: "Every person engaged in activities to which the Act and Regulation apply shall comply with requirements for design, construction, erection, activation, maintenance, alteration, repair, service or disposal.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "general requirement compliance activities design construction erection activation maintenance alteration repair service disposal"
  },
  {
    id: "211-01-3.1",
    regulation: "Ontario Regulation 211/01",
    section: "3.1",
    title: "Risk and safety management plan, certain facilities",
    description: "Requirements for Level 1 and Level 2 risk and safety management plans for retail outlets, filling plants, cardlock/keylock facilities, private outlets and container refill centres based on total capacity.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "risk safety management plan facilities retail outlets filling plants cardlock keylock private outlets container refill centres capacity"
  },
  {
    id: "211-01-4",
    regulation: "Ontario Regulation 211/01",
    section: "4",
    title: "Regulated activities",
    description: "No person shall operate, install, alter, repair, service or remove any appliance or equipment or use, supply, transport, store, handle or transfer propane except in accordance with this Regulation.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "regulated activities operate install alter repair service remove appliance equipment supply transport store handle transfer propane"
  },
  {
    id: "211-01-5",
    regulation: "Ontario Regulation 211/01",
    section: "5",
    title: "Duty of employer",
    description: "Employers must instruct employees to comply with the Act and Regulation, ensure training in emergency procedures, and maintain records of training and equipment testing.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "duty employer employees training emergency procedures records equipment testing"
  },
  {
    id: "211-01-6",
    regulation: "Ontario Regulation 211/01",
    section: "6",
    title: "Certificate required to handle propane",
    description: "No person shall handle propane unless the person is the holder of a certificate or ROT for that purpose.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "certificate required handle propane ROT holder"
  },
  {
    id: "211-01-7",
    regulation: "Ontario Regulation 211/01",
    section: "7",
    title: "Registration of contractor",
    description: "No person shall act as a contractor unless registered. Exemptions provided for certain activities including appliance sales and assembly.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "registration contractor exemptions appliance sales assembly"
  },
  {
    id: "211-01-8",
    regulation: "Ontario Regulation 211/01",
    section: "8",
    title: "Certificate required for various activities",
    description: "Certificate or ROT required to install, alter, purge, activate, repair, service or remove any appliance or equipment. Exemption when done under supervision of certificate holder.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "certificate activities install alter purge activate repair service remove appliance equipment supervision"
  },
  {
    id: "211-01-15",
    regulation: "Ontario Regulation 211/01",
    section: "15",
    title: "Occurrence or accident",
    description: "Requirements for notification of carbon monoxide poisoning, asphyxiation, explosion or fire occurrences. Procedures for scene preservation and investigation.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "occurrence accident notification carbon monoxide poisoning asphyxiation explosion fire scene preservation investigation"
  },
  {
    id: "211-01-25",
    regulation: "Ontario Regulation 211/01",
    section: "25",
    title: "Vehicle operation",
    description: "Requirements for operation of propane vehicles including labeling, fuel system compliance, shut-off procedures during fueling, and parking restrictions.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 211/01",
    subtitle: "Propane Storage and Handling",
    type: "clause",
    keywords: "vehicle operation propane vehicles labeling fuel system compliance shut-off procedures fueling parking restrictions"
  },

  // Ontario Regulation 212/01 - Gaseous Fuels
  {
    id: "212-01-1",
    regulation: "Ontario Regulation 212/01",
    section: "1",
    title: "Interpretation",
    description: "Definitions for gaseous fuels regulation including appliance, approved, gas, handling, pipeline, and VRA (vehicle refuelling appliance).",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 212/01",
    subtitle: "Gaseous Fuels",
    type: "clause",
    keywords: "interpretation definitions gaseous fuels appliance approved gas handling pipeline VRA vehicle refuelling"
  },
  {
    id: "212-01-2",
    regulation: "Ontario Regulation 212/01",
    section: "2",
    title: "Application",
    description: "Applies to installation, testing, maintenance, repair, removal, replacement, inspection and use of appliances, equipment, components and accessories where gaseous fuels are used for fuel purposes.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 212/01",
    subtitle: "Gaseous Fuels",
    type: "clause",
    keywords: "application installation testing maintenance repair removal replacement inspection use appliances equipment components accessories gaseous fuels"
  },
  {
    id: "212-01-6",
    regulation: "Ontario Regulation 212/01",
    section: "6",
    title: "Certificates required for various activities",
    description: "Certificate required to install, alter, purge, activate, repair, service or remove appliances, equipment or things used in gas handling. Exemptions for duct cleaning and supervision.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 212/01",
    subtitle: "Gaseous Fuels",
    type: "clause",
    keywords: "certificates activities install alter purge activate repair service remove appliances equipment gas handling duct cleaning supervision"
  },
  {
    id: "212-01-13",
    regulation: "Ontario Regulation 212/01",
    section: "13",
    title: "Unacceptable condition - immediate hazard",
    description: "Procedures when appliance or work is in unacceptable condition constituting immediate hazard. Requirements for distributor and certificate holder actions.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 212/01",
    subtitle: "Gaseous Fuels",
    type: "clause",
    keywords: "unacceptable condition immediate hazard procedures appliance work distributor certificate holder actions"
  },
  {
    id: "212-01-16",
    regulation: "Ontario Regulation 212/01",
    section: "16",
    title: "Supply of gas",
    description: "Distributor requirements for gas supply including inspection obligations and quality assurance programs.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 212/01",
    subtitle: "Gaseous Fuels",
    type: "clause",
    keywords: "supply gas distributor requirements inspection obligations quality assurance programs"
  },

  // Ontario Regulation 215/01 - Fuel Industry Certificates
  {
    id: "215-01-1",
    regulation: "Ontario Regulation 215/01",
    section: "1",
    title: "Interpretation",
    description: "Definitions including appliance, approved, direct supervision, general supervision, record of training, and supervising certificate holder.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 215/01",
    subtitle: "Fuel Industry Certificates",
    type: "clause",
    keywords: "interpretation definitions appliance approved direct supervision general supervision record training supervising certificate holder"
  },
  {
    id: "215-01-3",
    regulation: "Ontario Regulation 215/01",
    section: "3",
    title: "Certificates",
    description: "Comprehensive list of fuel industry certificates including gas technician levels (G.1, G.2, G.3), propane certificates (LP, PPO), oil burner technician certificates (OBT), and specialized certificates.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 215/01",
    subtitle: "Fuel Industry Certificates",
    type: "clause",
    keywords: "certificates gas technician G1 G2 G3 propane LP PPO oil burner technician OBT specialized certificates"
  },
  {
    id: "215-01-20",
    regulation: "Ontario Regulation 215/01",
    section: "20",
    title: "G.1 certificate",
    description: "G.1 certificate holders may install, inspect, alter, purge, activate, repair, service or remove natural gas or propane appliances of any BTU input and associated equipment and accessories.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 215/01",
    subtitle: "Fuel Industry Certificates",
    type: "clause",
    keywords: "G1 certificate install inspect alter purge activate repair service remove natural gas propane appliances BTU input equipment accessories"
  },
  {
    id: "215-01-21",
    regulation: "Ontario Regulation 215/01",
    section: "21",
    title: "G.2 certificate",
    description: "G.2 certificate holders may work on natural gas or propane appliances with input of 400,000 BTU/h or less and associated equipment and accessories.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 215/01",
    subtitle: "Fuel Industry Certificates",
    type: "clause",
    keywords: "G2 certificate natural gas propane appliances 400000 BTU input equipment accessories"
  },
  {
    id: "215-01-22",
    regulation: "Ontario Regulation 215/01",
    section: "22",
    title: "G.3 certificate",
    description: "G.3 certificate holders may perform limited functions under supervision including gas piping installation, appliance reactivation, cleaning and vent work.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 215/01",
    subtitle: "Fuel Industry Certificates",
    type: "clause",
    keywords: "G3 certificate limited functions supervision gas piping installation appliance reactivation cleaning vent work"
  },
  {
    id: "215-01-55",
    regulation: "Ontario Regulation 215/01",
    section: "55",
    title: "Exemptions",
    description: "Exemptions from certificate requirements for detached dwelling owners, portable appliances, reactivation, construction of OEM vehicles, and other specified activities.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 215/01",
    subtitle: "Fuel Industry Certificates",
    type: "clause",
    keywords: "exemptions certificate requirements detached dwelling owners portable appliances reactivation OEM vehicles specified activities"
  },

  // Ontario Regulation 220/01 - Boilers and Pressure Vessels
  {
    id: "220-01-1",
    regulation: "Ontario Regulation 220/01",
    section: "1",
    title: "Interpretation",
    description: "Definitions for boiler and pressure vessel regulation including alteration, boiler, certificate of inspection, design, fired vessel, fitting, pressure vessel, and repair.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 220/01",
    subtitle: "Boilers and Pressure Vessels",
    type: "clause",
    keywords: "interpretation definitions boiler pressure vessel alteration certificate inspection design fired vessel fitting repair"
  },
  {
    id: "220-01-4",
    regulation: "Ontario Regulation 220/01",
    section: "4",
    title: "Design registration requirement",
    description: "No person shall manufacture a boiler, pressure vessel, fitting or piping for use in Ontario unless its design is registered with the director. Professional engineer signature required.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 220/01",
    subtitle: "Boilers and Pressure Vessels",
    type: "clause",
    keywords: "design registration requirement manufacture boiler pressure vessel fitting piping Ontario director professional engineer signature"
  },
  {
    id: "220-01-5",
    regulation: "Ontario Regulation 220/01",
    section: "5",
    title: "Requirement for certificate of inspection",
    description: "No person shall operate or use boiler, pressure vessel, fitting or piping unless director has issued current certificate of inspection stating it has passed inspection.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 220/01",
    subtitle: "Boilers and Pressure Vessels",
    type: "clause",
    keywords: "requirement certificate inspection operate use boiler pressure vessel fitting piping director current certificate passed inspection"
  },
  {
    id: "220-01-10",
    regulation: "Ontario Regulation 220/01",
    section: "10",
    title: "Periodic inspections",
    description: "Requirements for periodic inspections of boilers and pressure vessels by inspectors or insurers at prescribed intervals. Inspection reporting and record keeping requirements.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 220/01",
    subtitle: "Boilers and Pressure Vessels",
    type: "clause",
    keywords: "periodic inspections boilers pressure vessels inspectors insurers prescribed intervals inspection reporting record keeping"
  },
  {
    id: "220-01-13",
    regulation: "Ontario Regulation 220/01",
    section: "13",
    title: "Welding and brazing requirements",
    description: "Welding and brazing procedures must be established per code adoption document. Testing and certification requirements for welders, welding operators, brazers and brazing operators.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 220/01",
    subtitle: "Boilers and Pressure Vessels",
    type: "clause",
    keywords: "welding brazing requirements procedures code adoption document testing certification welders welding operators brazers brazing operators"
  },

  // Ontario Regulation 223/01 - Codes and Standards Adopted by Reference
  {
    id: "223-01-1",
    regulation: "Ontario Regulation 223/01",
    section: "1",
    title: "Amusement Devices Code Adoption Document",
    description: "Adoption by reference of the Amusement Devices Code Adoption Document as part of Ontario Regulation 221/01, including amendments made from time to time.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 223/01",
    subtitle: "Codes and Standards Adopted by Reference",
    type: "clause",
    keywords: "amusement devices code adoption document reference Ontario Regulation 221/01 amendments"
  },
  {
    id: "223-01-6",
    regulation: "Ontario Regulation 223/01",
    section: "6",
    title: "Gaseous Fuels Code Adoption Document",
    description: "Adoption by reference of the Gaseous Fuels Code Adoption Document as part of Ontario Regulation 212/01, including amendments made from time to time.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 223/01",
    subtitle: "Codes and Standards Adopted by Reference",
    type: "clause",
    keywords: "gaseous fuels code adoption document reference Ontario Regulation 212/01 amendments"
  },
  {
    id: "223-01-9",
    regulation: "Ontario Regulation 223/01",
    section: "9",
    title: "Propane Code Adoption Document",
    description: "Adoption by reference of the Propane Code Adoption Document as part of Ontario Regulation 211/01, including amendments made from time to time.",
    document_title: "Technical Standards and Safety Act, 2000 - Ontario Regulation 223/01",
    subtitle: "Codes and Standards Adopted by Reference",
    type: "clause",
    keywords: "propane code adoption document reference Ontario Regulation 211/01 amendments"
  },

  // Technical Standards and Safety Act, 2000 - Main Act
  {
    id: "TSSA-1",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "1",
    title: "Purpose",
    description: "The purpose of this Act is to enhance public safety in Ontario by providing for the efficient and flexible administration of technical standards.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act",
    type: "section",
    keywords: "purpose enhance public safety Ontario efficient flexible administration technical standards"
  },
  {
    id: "TSSA-2",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "2",
    title: "Application",
    description: "This Act applies to amusement devices, boilers and pressure vessels, elevating devices, fuels, and operating engineers.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act",
    type: "section",
    keywords: "application amusement devices boilers pressure vessels elevating devices fuels operating engineers"
  },
  {
    id: "TSSA-3.1",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "3.1",
    title: "Corporation continued",
    description: "The Technical Standards and Safety Authority is continued as a corporation without share capital under the name Technical Standards and Safety Authority.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act",
    type: "section",
    keywords: "corporation continued Technical Standards Safety Authority TSSA corporation share capital"
  },
  {
    id: "TSSA-6",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "6",
    title: "Requirement for authorization",
    description: "Authorization required before carrying out prescribed activities or operating things referred to in regulations. Requirements for granting, refusing, suspending or revoking authorizations.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act",
    type: "section",
    keywords: "requirement authorization prescribed activities operating things regulations granting refusing suspending revoking"
  },
  {
    id: "TSSA-14",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "14",
    title: "Safety orders",
    description: "Director may give safety orders to any person or class of persons with respect to any matter governed by this Act that pertains to safety, including shutdown or restricted use orders.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act",
    type: "section",
    keywords: "safety orders director person class persons matter governed Act pertains safety shutdown restricted use"
  },
  {
    id: "TSSA-17",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "17",
    title: "Inspection",
    description: "Inspector may conduct inspections and enter premises where regulated things are used, operated, installed, manufactured, repaired or offered for sale to ensure compliance and safety.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act",
    type: "section",
    keywords: "inspection inspector conduct enter premises regulated things used operated installed manufactured repaired offered sale compliance safety"
  },
  {
    id: "TSSA-32.1",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "32.1",
    title: "Administrative penalties",
    description: "A director may impose an administrative penalty on a person who contravenes this Act, the regulations, a Minister's order or an alternate rule.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act",
    type: "section",
    keywords: "administrative penalties director impose penalty person contravenes Act regulations Minister order alternate rule"
  }
];

  // Add more entries for each section of 211/01 and then start with 212/01, 215/01, etc.
  // You can copy the actual content from your JSON files and format them like this

  // Ontario Regulation 212/01 entries would go here
  // Ontario Regulation 215/01 entries would go here  
  // Ontario Regulation 220/01 entries would go here
  // Ontario Regulation 223/01 entries would go here

// Create search index for regulations
export const createRegulationSearchIndex = (data) => {
  const index = new Map();
  
  data.forEach((item, idx) => {
    const searchableText = [
      item.title || '',
      item.description || '',
      item.section || '',
      item.regulation || '',
      item.keywords || '',
      item.document_title || '',
      item.subtitle || ''
    ].join(' ').toLowerCase();
    
    const words = searchableText.split(/\s+/).filter(word => 
      word.length > 2 && 
      !['the', 'and', 'for', 'are', 'but', 'not', 'you', 'all', 'can', 'had', 'her', 'was', 'one', 'our', 'out', 'day', 'get', 'has', 'him', 'his', 'how', 'man', 'new', 'now', 'old', 'see', 'two', 'way', 'who', 'boy', 'did', 'its', 'let', 'put', 'say', 'she', 'too', 'use'].includes(word)
    );
    
    words.forEach(word => {
      if (!index.has(word)) {
        index.set(word, new Set());
      }
      index.get(word).add(idx);
    });
  });
  
  return index;
};

// Search regulations function
export const searchRegulations = (query, searchIndex) => {
  if (!query || !searchIndex) return [];
  
  const searchTerm = query.toLowerCase().trim();
  const words = searchTerm.split(/\s+/);
  
  let resultIndices = new Set();
  
  words.forEach(word => {
    if (searchIndex.has(word)) {
      searchIndex.get(word).forEach(idx => resultIndices.add(idx));
    }
    
    if (word.length > 3) {
      searchIndex.forEach((indices, indexWord) => {
        if (indexWord.includes(word) || word.includes(indexWord)) {
          indices.forEach(idx => resultIndices.add(idx));
        }
      });
    }
  });
  
  const simpleResults = regulationsData.filter(item => {
    const searchableText = [
      item.title || '',
      item.description || '',
      item.section || '',
      item.regulation || '',
      item.document_title || ''
    ].join(' ').toLowerCase();
    
    return searchableText.includes(searchTerm);
  });
  
  const indexResults = Array.from(resultIndices).map(idx => regulationsData[idx]);
  const allResults = [...indexResults, ...simpleResults];
  const uniqueResults = allResults.filter((item, index, self) => 
    index === self.findIndex(t => t.id === item.id)
  );
  
  return uniqueResults.sort((a, b) => {
    const aTitle = (a.title || '').toLowerCase();
    const bTitle = (b.title || '').toLowerCase();
    const queryLower = searchTerm.toLowerCase();
    
    if (aTitle.includes(queryLower) && !bTitle.includes(queryLower)) return -1;
    if (!aTitle.includes(queryLower) && bTitle.includes(queryLower)) return 1;
    
    return 0;
  }).slice(0, 50);
};