// CSA B149.2-25 Propane Storage and Handling Code - Complete Data

// Export the CSA B149.2 data directly (no JSON import needed)
export const csaB149Data = {
  "document": {
    "title": "CSA B149.2:25 Propane storage and handling code",
    "published_date": "February 2025",
    "publisher": "Canadian Standards Association",
    "sections": {
      "section_3": {
        "title": "Definitions",
        "clauses": {
          "accessory": {
            "title": "Accessory",
            "description": "a part capable of performing an independent function and contributing to the operation of the appliance that it serves."
          },
          "aerosol_container": {
            "title": "Aerosol container",
            "description": "a non-refillable container meeting the requirements for 2P, 2Pl, 2Q, 2Q2, or 2R aerosol containers for containment and transportation of propane under the Transportation of Dangerous Goods Regulations of Transport Canada."
          },
          "appliance": {
            "title": "Appliance",
            "description": "a device to convert propane into energy (including any component, control, wiring, piping, or tubing required to be part of the device)."
          },
          "approved": {
            "title": "Approved",
            "description": "acceptable to the authority having jurisdiction."
          },
          "authority_having_jurisdiction": {
            "title": "Authority having jurisdiction",
            "description": "the governmental body responsible for the enforcement of any part of this Code, or the official or agency designated by that body to exercise such a function."
          },
          "boiler": {
            "title": "Boiler",
            "description": "an appliance intended to supply hot liquid or vapour for space-heating, processing, or power purposes."
          },
          "building": {
            "title": "Building",
            "description": "a structure or part of a structure used or intended for supporting or sheltering persons, animals, or property and classified by its occupancy in accordance with the applicable building code of the authority having jurisdiction or, in the absence of such, in accordance with the National Building Code of Canada.",
            "subcategories": {
              "assembly_building": "any building or part of a building used by a gathering of persons for civic, political, travel, religious, social, educational, recreational, or like purpose, or for the consumption of food or drink.",
              "care_or_detention_occupancy_building": "any building or part of a building used or occupied by persons who require special care or treatment because of cognitive or physical limitations, or by persons who are incapable of self-preservation and who are restrained from self-destruction by security measures not under their control.",
              "commercial_building": "any building used in connection with direct trade with, or service for, the public.",
              "industrial_building": "any building used in connection with production or process work or with storage or warehousing.",
              "residential_building": "any building or part of a building used by persons for whom sleeping accommodation is provided but who are not harboured or detained to receive medical care or treatment or are not involuntarily detained."
            }
          },
          "burner": {
            "title": "Burner",
            "description": "a device or group of devices forming an integral unit for the introduction of propane, with or without air or oxygen, into the combustion zone for ignition."
          },
          "cargo_liner": {
            "title": "Cargo liner",
            "description": "vehicle that is used to transport propane in which the tank constitutes the main structural member and that is towed by a separate motor vehicle."
          },
          "certified": {
            "title": "Certified",
            "description": "investigated and identified by a designated testing organization as conforming to recognized standards, requirements, or accepted test reports."
          },
          "combustible": {
            "title": "Combustible",
            "description": "material that fails to conform to CAN/ULC-S114 requirements for noncombustibility."
          },
          "combustible_liquid": {
            "title": "Combustible liquid",
            "description": "a liquid that has a flashpoint at or above 100 °F (38 °C) and below 200 °F (93 °C)."
          },
          "combustion_air": {
            "title": "Combustion air",
            "description": "the air required for satisfactory combustion of propane, including excess air."
          },
          "commercial_and_industrial_type_appliance": {
            "title": "Commercial and industrial-type appliance or equipment",
            "description": "an appliance or equipment other than a residential or recreational type."
          },
          "component": {
            "title": "Component",
            "description": "an essential part of an appliance or equipment."
          },
          "connected_for_use": {
            "title": "Connected for use",
            "description": "a propane container that is properly connected to an appliance in accordance with the provisions of this Code."
          },
          "connector": {
            "title": "Connector",
            "description": "tubing or hose with a fitting at each end for connecting an appliance or equipment with piping or tubing.",
            "subcategories": {
              "hose_connector": "a flexible assembled conduit not exceeding 6 ft (1.8 m) in length.",
              "metal_connector": "a corrugated or semi-rigid conduit made entirely of metal."
            }
          },
          "construction_heater": {
            "title": "Construction heater",
            "description": "portable direct-fired unvented heater intended only for temporary use in heating buildings under construction, alteration, or repair."
          },
          "construction_site": {
            "title": "Construction site",
            "description": "a temporary worksite involving construction activities such as the erection, alteration, and dismantling or demolition of a building or equipment, re-roofing of a building, or digging."
          },
          "container": {
            "title": "Container",
            "description": "either an aerosol container, a cylinder, or a tank."
          },
          "container_refill_centre": {
            "title": "Container refill centre (propane service station)",
            "description": "an area, including a building, in which propane is dispensed into containers, and in which propane storage containers, piping, and pertinent equipment, including a dispensing system, can be located."
          },
          "cylinder": {
            "title": "Cylinder",
            "description": "a container designed and manufactured in accordance with a cylinder specification authorized for the containment and transportation of propane under the Transportation of Dangerous Goods (TDG) Regulations of Transport Canada."
          },
          "cylinder_system": {
            "title": "Cylinder system",
            "description": "an assembly that includes the cylinder base or bracket, cylinder, cylinder valve, connector, manifold valve assembly, regulator, and relief valve, or any combination of these."
          },
          "direct_vent_appliance": {
            "title": "Direct-vent appliance",
            "description": "an appliance constructed so that all the combustion air is supplied directly from, and the products of combustion are vented directly to, the outdoors by independent enclosed passageways connected directly to the appliance."
          },
          "dispensing_system": {
            "title": "Dispensing system",
            "description": "a system, consisting of tank, pump and motor, propane dispenser, and associated piping and supports, for the storage, metering, and dispensing of liquid propane into containers."
          },
          "dwelling_unit": {
            "title": "Dwelling unit",
            "description": "a housekeeping unit used or intended to be used as a domicile by one or more persons, and usually containing cooking, eating, living, sleeping, and sanitary facilities."
          },
          "enclosure": {
            "title": "Enclosure",
            "description": "a secondary structure (room) within or attached to a structure (building) in which an appliance is installed."
          },
          "equipment": {
            "title": "Equipment",
            "description": "a device, other than an appliance, accessory, or component, that is connected to a piping or tubing system."
          },
          "filling_density": {
            "title": "Filling density",
            "description": "the percentage ratio of the weight of the propane in a container to the weight of water the container will hold at 59 °F (15 °C)."
          },
          "filling_plant": {
            "title": "Filling plant (bulk plant)",
            "description": "a facility, the primary purpose of which is the distribution of propane. Such plants have bulk storage or container filling or vehicle transfer facilities on the premises. Bulk plants are considered part of this category."
          },
          "fitting": {
            "title": "Fitting",
            "description": "an item in a piping or tubing system that is used as a means of connection, such as an elbow, return bend, tee, union, bushing, coupling, cross, or nipple; the term does not include such functioning items as a valve or pressure regulator."
          },
          "flue": {
            "title": "Flue",
            "description": "an enclosed passageway for conveying flue gases."
          },
          "flue_gases": {
            "title": "Flue gases",
            "description": "combustion products and excess air."
          },
          "furnace": {
            "title": "Furnace",
            "description": "an indirect-fired, flue-connected, space-heating appliance that uses warm air as the heating medium and usually has provision for the attachment of ducts."
          },
          "garage": {
            "title": "Garage",
            "subcategories": {
              "private_garage": "a building, designed for the parking, storage, or repair of vehicles used to transport propane, that is approved by the authority having jurisdiction for its purpose and is located on property owned or leased by the owner of the vehicles.",
              "repair_garage": "a building or part of a building where facilities are provided for the repair or servicing of motor vehicles.",
              "storage_garage": "a building or part thereof used or intended for either the storage or parking of motor vehicles and that contains no provision for either the repair or servicing of such vehicles."
            }
          },
          "gas_cartridge": {
            "title": "Gas cartridge",
            "description": "a non-refillable container meeting the requirements for 2P, 2P2, or 2Q gas cartridges for containment and transportation of propane under Transport Canada's Transportation of Dangerous Goods Regulations."
          },
          "hose": {
            "title": "Hose (gas hose)",
            "description": "a flexible conduit."
          },
          "ignition": {
            "title": "Ignition",
            "description": "the establishment of a flame."
          },
          "installer": {
            "title": "Installer",
            "description": "any individual, firm, corporation, or company that either directly or through a representative is engaged in the installation, replacement, repair, or servicing of propane piping, venting systems, appliances, components, accessories, or equipment, and whose representative is either experienced or trained, or both, in such work and has complied with the requirements of the authority having jurisdiction."
          },
          "kiosk": {
            "title": "Kiosk",
            "description": "a structure that has an area of less than 100 ft² (9.3 m²) located on a propane dispenser or vehicle fuel dispenser island that provides shelter and contains the necessary equipment to permit a person to perform his or her duties."
          },
          "mechanical_air_intake": {
            "title": "Mechanical air intake",
            "description": "a means to mechanically provide ventilation and/or combustion air requirements to a building."
          },
          "mobile_housing": {
            "title": "Mobile housing",
            "description": "a term that includes all of the following structures:",
            "subcategories": {
              "mobile_home": "a dwelling that consists of a vehicular portable structure built on a chassis and designed to be used with or without a permanent foundation and to be connected to indicated utilities.",
              "mobile_industrial_or_commercial_structure": "a structure that is not intended as a dwelling unit, is towable on its own chassis, and is designed for use without a permanent foundation. Such a structure is built specifically for commercial or industrial use, such as a construction office, bunkhouse, wash house, kitchen and dining unit, library, television unit, industrial display unit, laboratory unit, or medical clinic.",
              "multiple_section_mobile_home": "a single structure composed of separate mobile units, each towable on its own chassis; when the units are towed to the site, they are coupled together mechanically and electrically to form the single structure. These structures are sometimes referred to as double-wide mobile homes when only two units are joined together.",
              "swing_out_and_expandable_room_section_mobile_home": "a mobile home that can be telescoped when towed and expanded later for additional capacity."
            }
          },
          "noncombustible": {
            "title": "Noncombustible",
            "description": "material that conforms to CAN/ULC-S114 requirements for noncombustibility."
          },
          "overfill_prevention_device": {
            "title": "Overfill prevention device",
            "description": "a safety device that is designed to provide an automatic means to prevent the filling of a container in excess of the maximum permitted filling limit."
          },
          "pilot": {
            "title": "Pilot",
            "description": "a flame that is used to ignite a gas/air or propane/air mixture at the main burner(s)."
          },
          "point_of_transfer": {
            "title": "Point of transfer",
            "description": "the dispensing hose inlet connection."
          },
          "pol": {
            "title": "POL",
            "description": "a commonly employed fitting used for propane and meeting the requirements for Connection No. 510 as specified in CGA V-1."
          },
          "propane_dispenser": {
            "title": "Propane dispenser",
            "description": "an assembly intended to dispense liquid propane and controlled by a human operator. The assembly can include a pressure relief device (PRD), vapour separator, strainer, metering assembly, meter register (mechanical or electronic), control valves, hose, hose nozzle, controls (mechanical or electronic), interlocking mechanism, locking mechanism, weigh scale, and associated wiring, piping fittings, and housing."
          },
          "purge": {
            "title": "Purge",
            "description": "to replace the existing fluid (gaseous or liquid) in piping, tubing, equipment, a container, or an appliance with a desired fluid."
          },
          "quick_disconnect_device": {
            "title": "Quick-disconnect device",
            "description": "a hand-operated device that is used for connecting and disconnecting either an appliance or an appliance connector to a propane supply and that is equipped with an automatic means to shut off the propane supply when the device is disconnected."
          },
          "readily_accessible": {
            "title": "Readily accessible",
            "description": "capable of being reached quickly for operation, renewal, servicing, or inspection, without requiring climbing over, or the removal of, an obstacle or the use of a portable ladder."
          },
          "recreational_vehicle": {
            "title": "Recreational vehicle",
            "description": "a portable structure intended as temporary accommodation for travel, vacation, or recreational use. Such structures include a chassis-mounted camper, motorized home, slide-in camper, tent trailer, or travel trailer.",
            "subcategories": {
              "chassis_mounted_camper": "an accommodation body that attaches onto a truck chassis and is not intended for removal.",
              "motorized_home": "a vehicular portable structure of self-propelled design.",
              "slide_in_camper": "an accommodation body that fits into a standard vehicle and is designed to be easily removable.",
              "tent_trailer": "a vehicular portable structure built on its own chassis and having a rigid or canvas top and side walls that can be folded or otherwise condensed for transit.",
              "travel_trailer": "a vehicular portable structure intended to be towed by a motor vehicle and that does not fold up or reduce in size for transit."
            }
          },
          "regulator": {
            "title": "Regulator",
            "subcategories": {
              "pressure_regulator": "a device, either adjustable or nonadjustable, for controlling and maintaining, within acceptable limits, a uniform outlet pressure.",
              "two_stage_regulation": "a pressure-reducing system that reduces container pressure to utilization pressure by the use of two separate regulators in series or a combination two-stage regulator."
            }
          },
          "relief_device": {
            "title": "Relief device",
            "description": "a device designed to open to prevent a rise of propane pressure in excess of a specified value due to an emergency or abnormal conditions."
          },
          "safety_limit_control": {
            "title": "Safety limit control",
            "description": "a safety control intended to prevent an unsafe condition of temperature, pressure, or liquid level."
          },
          "self_service_vehicle_fuel_dispenser": {
            "title": "Self-service vehicle fuel dispenser",
            "description": "a vehicle fuel dispenser for use by the public for conducting dispensing operations."
          },
          "set_pressure": {
            "title": "Set pressure",
            "description": "the start-to-discharge pressure for which a relief valve is set and marked."
          },
          "structure": {
            "title": "Structure",
            "description": "the entire building in which an appliance is installed."
          },
          "tank": {
            "title": "Tank (with respect to propane storage)",
            "description": "the class of container for the storage of propane, designed and fabricated in accordance with CSA B51."
          },
          "tank_trailer": {
            "title": "Tank trailer",
            "description": "a unit on which a tank of not more than 2000 USWG (7500 L) capacity is permanently mounted on a chassis and is towed by another vehicle."
          },
          "tank_truck": {
            "title": "Tank truck",
            "description": "a truck chassis and tank assembly as a complete unit for the bulk delivery of propane."
          },
          "underground_tank": {
            "title": "Underground tank",
            "description": "a tank that is buried completely or partly below the ground level and covered with earth, sand, or other material or mounded partly below the ground level or above ground level and covered with earth, sand, or other material."
          },
          "valve": {
            "title": "Valve",
            "description": "a device by which the flow of a fluid can be started, stopped, or regulated by a movable part that opens or obstructs passage.",
            "subcategories": {
              "back_check_valve": "a valve that is normally closed and allows flow in only one direction.",
              "cylinder_valve": "a valve fitted to a cylinder.",
              "emergency_shut_off_valve": "a valve that is part of a system that is designed to limit and shut down the flow of propane in the event that a vehicle moves away from a transfer point with the transfer hose or swivel-type piping connected to it.",
              "excess_flow_valve": "a valve designed to close when the liquid or vapour passing through it exceeds a prescribed flow rate as determined by a pressure drop across the valve.",
              "fast_closing_valve": "an automatic valve that has a closing time of less than 5 s upon being de-energized.",
              "hydrostatic_relief_valve": "a pressure relief valve installed in a liquid propane line.",
              "internal_excess_flow_valve": "an excess-flow valve that remains functional within the tank when any portion of the valve external to the tank's perimeter is sheared off or otherwise damaged. An internal excess-flow valve can be integral to another valve.",
              "internal_relief_valve": "a pressure relief valve that is built into the body of the diaphragm assembly of a pressure regulator.",
              "internal_valve": "a valve designed and installed so that its seat is within a tank and the arrangement of the parts of the valve is such that damage to the parts outside the tank will not prevent effective seating of the valve.",
              "line_relief_valve": "a relief valve installed in the piping or tubing system downstream of a final-stage pressure regulator that is not equipped with an internal relief valve.",
              "safety_shut_off_valve": "a valve that automatically shuts off the supply of propane when de-energized by a combustion safety control, safety limit control, or loss of actuating medium.",
              "stop_fill_valve": "a device in a container that is intended to automatically shut off the flow of liquid into the container when a predetermined fixed level is achieved."
            }
          },
          "vaporizer": {
            "title": "Vaporizer",
            "description": "a device for converting liquid propane to vapour by means other than atmospheric heat transfer through the surface of the container.",
            "subcategories": {
              "direct_fired_tank_heater": "an open-flame device that applies hot gas from the combustion chamber directly to a portion of the container surface in contact with propane liquid. Considered to be a source of ignition. Does not include devices certified for use in hazardous locations.",
              "direct_fired_vaporizer": "a vaporizer in which heat furnished by a flame is directly applied to a heat exchange surface in contact with the liquid propane, other than that of a storage tank or container, for the purpose of vaporization. Considered to be an appliance, and a source of ignition unless otherwise certified.",
              "direct_immersion_electric_vaporizer": "a vaporizer in which an electric element is immersed directly in the propane liquid to be vaporized.",
              "indirect_electric_vaporizer": "a vaporizer in which an electric element heats an interface into which the propane heat exchanger is situated.",
              "indirect_vaporizer": "a vaporizer in which heat furnished by steam, hot water, or another heating medium is applied to a vaporizing chamber's tubing, pipe coils, or other heat exchange surface containing the liquid propane to be vaporized. The heating of the medium being used occurs at a point remote from the vaporizer.",
              "tank_heater": "a form of vaporizer used to apply heat either directly to a portion of the container surface in contact with propane liquid or indirectly by circulating propane liquid from the container to the device and then back to the container.",
              "waterbath_vaporizer": "a vaporizer in which a vaporizing chamber's tubing, pipe coils, or other heat exchange surface containing the liquid propane to be vaporized is immersed in a temperature-controlled bath of water, water-glycol combination, or another noncombustible heat transfer medium that is heated by an immersion heater not in contact with the propane heat exchange surface. When gas fired, such devices are considered to be an appliance, and are a source of ignition unless otherwise certified."
            }
          },
          "vehicle_fuel_dispenser": {
            "title": "Vehicle fuel dispenser",
            "description": "a propane dispenser, specifically for dispensing liquid propane by volume into containers."
          },
          "vent": {
            "title": "Vent",
            "description": "that portion of a venting system designed to convey flue gases directly to the outdoors from either a vent connector or an appliance when a vent connector is not used."
          },
          "ventilation": {
            "title": "Ventilation (with respect to the space in which an appliance is installed)",
            "description": "the removal of inside air, leaked or spilled products of combustion, or flue gases from the space in which an appliance is installed to outside the space, and the replacement of same by air from outside the space."
          }
        }
      },
      "section_4": {
        "title": "General",
        "clauses": {
          "4_1": {
            "title": "Application",
            "subclauses": {
              "4_1_1": {
                "title": "Propane and butane requirements",
                "description": "For the purposes of this Code, the requirements contained in CAN/CGSB-3.14 for propane or CAN/CGSB-3.13 for butane shall apply."
              },
              "4_1_2": {
                "title": "Code conflicts",
                "description": "When a specification or document referenced in Clause 2 contains a requirement that conflicts with a requirement in this Code, the requirement in this Code shall govern, except in the case of Canadian (federal), provincial, or territorial regulations."
              },
              "4_1_3": {
                "title": "Installation instructions",
                "description": "An appliance, an accessory, a component, equipment, or any other item shall be installed in accordance with the manufacturer's certified installation instructions and with this Code."
              },
              "4_1_4": {
                "title": "Conflicts",
                "description": "Where a conflict exists between the manufacturer's installation instructions and this Code, the requirements of this Code shall prevail unless otherwise approved."
              }
            }
          },
          "4_2": {
            "title": "Approval of appliances, accessories, components, equipment, and material",
            "subclauses": {
              "4_2_1": {
                "title": "Installation",
                "description": "An appliance, an accessory, a component, equipment, or material used in an installation shall be of a type and rating approved for the specific purpose for which it is employed."
              },
              "4_2_2": {
                "title": "Deviation",
                "description": "When deviation from or postponement of these requirements is necessary, permission in writing shall be obtained from the authority having jurisdiction before the work proceeds, and this permission shall apply only to the particular installation for which it is given."
              },
              "4_2_3": {
                "title": "Assembly or construction approval",
                "description": "The approval of the assembly or construction of an appliance is subject to the authority having jurisdiction. (CSA B149.3 contains provisions for assembly and construction of appliances.)"
              }
            }
          },
          "4_3": {
            "title": "Responsibilities of the installer",
            "subclauses": {
              "4_3_1": {
                "title": "Initial installation",
                "description": "Before leaving installations, installers shall ensure that the appliance, accessory, component, or equipment they installed complies with the Code requirements, and the person initially activating the appliance shall ensure that the appliance is in safe working order."
              },
              "4_3_2": {
                "title": "Operation instruction",
                "description": "Installers shall instruct the user in the safe and correct operation of all appliances or equipment that they install."
              },
              "4_3_3": {
                "title": "Manufacturer instructions",
                "description": "The installer shall ensure that the manufacturer's instructions supplied with the appliance are left with the user."
              },
              "4_3_4": {
                "title": "Replacement parts",
                "description": "Before installing a replacement part of an appliance, the installer shall ensure that the replacement part provides operational characteristics at least equivalent to those of the original part."
              },
              "4_3_5": {
                "title": "Piping or tubing system pressure tests",
                "description": "It shall be the responsibility of the installer of a piping or tubing system to perform pressure tests in accordance with Clause 6.22.2 of CSA B149.1 and to ensure that the piping or tubing system is gas-tight at the completion of the tests."
              },
              "4_3_6": {
                "title": "Gas tight test",
                "description": "It shall be the responsibility of the installer of an appliance to perform tests in accordance with Clause 6.22.3 of CSA B149.1 and to ensure that the system is gas-tight at the completion of the tests."
              }
            }
          },
          "4_4": {
            "title": "Training and quality of labour",
            "subclauses": {
              "4_4_1": {
                "title": "Work quality",
                "description": "All work shall be done in a skillful, thorough manner. Careful attention shall be paid not only to the mechanical execution of the work but also to the arrangement of the installation."
              },
              "4_4_2": {
                "title": "Training",
                "description": "Personnel performing installation, operation, and maintenance work shall be properly trained in such functions."
              }
            }
          },
          "4_5": {
            "title": "Suitability of use",
            "subclauses": {
              "4_5_1": {
                "title": "Type of gas and pressure",
                "description": "An appliance shall not be installed unless it is designed for use with the type of gas to which it is to be connected and is suitable for the pressure supplied."
              },
              "4_5_2": {
                "title": "Hazards",
                "description": "The use of an appliance, an accessory, a component, equipment, or material shall be prohibited where a hazard is created."
              },
              "4_5_3": {
                "title": "Damaged appliances",
                "description": "An appliance that has been exposed to fire, explosion, flood, or other damage shall not be offered for sale, installed, reactivated, or reconnected to the supply until the appliance has been inspected by a person acceptable to the authority having jurisdiction."
              },
              "4_5_4": {
                "title": "Used appliances",
                "description": "Before reconnection to supply piping or tubing, a used appliance shall be inspected and determined by the installer to be safe for continued use."
              }
            }
          },
          "4_6": {
            "title": "Electrical connections and components",
            "subclauses": {
              "4_6_1": {
                "title": "Code requirements",
                "description": "Electrical connections between an appliance and building wiring shall comply with the local electrical code or, in the absence of such, with the Canadian Electrical Code, Part I."
              },
              "4_6_2": {
                "title": "Electrical circuits",
                "description": "An electrical circuit employed for operating an automatic main control valve, automatic pilot, room-temperature thermostat, safety limit control, or another electrical device used with an appliance shall be in accordance with the appliance wiring diagram."
              }
            }
          },
          "4_7": {
            "title": "Hazardous and corrosive locations",
            "subclauses": {
              "4_7_1": {
                "title": "Installation",
                "description": "An appliance shall not be installed in a room that has an atmosphere containing vapours corrosive to an appliance or venting system."
              },
              "4_7_2": {
                "title": "Approved installation",
                "description": "An appliance, unless certified or approved for installation in a hazardous location, shall not be installed in a location where a flammable vapour, combustible dust or fibres, or an explosive mixture is present."
              }
            }
          },
          "4_8": {
            "title": "Smoking",
            "description": "Smoking or providing any other source of ignition shall not be permitted in the area where work is being done on piping, tubing, or equipment that either contains or has contained propane, unless the piping, tubing, or equipment has been purged of all propane as outlined in Clause 6.23 of CSA B149.1."
          },
          "4_9": {
            "title": "Isolation of safety devices",
            "description": "Isolating or rendering inoperative a safety shut-off valve, safety limit control, or relief device shall be prohibited."
          },
          "4_10": {
            "title": "Leak detection",
            "subclauses": {
              "4_10_1": {
                "title": "Sources of ignition",
                "description": "A match, candle, flame, or other source of ignition shall not be used to check for a propane leak."
              },
              "4_10_2": {
                "title": "Light and/or flashlight use",
                "description": "A light, including a flashlight, used in connection with a search for propane leakage shall be suitable for Group IIA hazardous locations."
              },
              "4_10_3": {
                "title": "Electrical switches",
                "description": "An electric switch either in or adjacent to an area of propane leakage shall not be operated unless it is suitable for Group IIA hazardous locations."
              }
            }
          },
          "4_11": {
            "title": "Appliance clearances to combustible material",
            "description": "Appliance clearances to combustible material shall be in accordance with Clause 4.13 of CSA B149.1."
          },
          "4_12": {
            "title": "Accessibility",
            "subclauses": {
              "4_12_1": {
                "title": "Installation",
                "description": "An appliance shall be installed so that it is accessible for servicing."
              },
              "4_12_2": {
                "title": "Service clearances",
                "description": "An appliance shall be installed with a minimum service clearance of 24 in (61 cm) from any side, top, or bottom where service could be necessary, except where a) a greater distance is indicated on the appliance rating plate; or b) the distance is not sufficient for the removal, replacement, or repair of a component, an accessory, or any equipment forming either an integral part of the appliance or connected to the appliance, in which case minimum service clearance shall be provided that is adequate to effect such removal, replacement, or repair."
              },
              "4_12_3": {
                "title": "Access dimensions",
                "description": "An access opening with minimum dimensions of 24 x 30 in (61 cm x 76 cm) shall be provided to the space in which an appliance is located."
              },
              "4_12_4": {
                "title": "Appliance passageway",
                "description": "A clear and unobstructed passageway at least 36 in (91 cm) high and 36 in (91 cm) wide shall be provided to each appliance."
              }
            }
          }
        }
      },
      "section_5": {
        "title": "General requirements for propane and propane equipment",
        "clauses": {
          "5_1": {
            "title": "Odourization",
            "subclauses": {
              "5_1_1": {
                "title": "Propane for fuel purposes",
                "description": "Propane distributed for fuel purposes shall be odourized in accordance with CAN/CGSB-3.14."
              },
              "5_1_2": {
                "title": "Responsibility for odourization",
                "description": "Odourization of the propane shall be the responsibility of the producer or processor, who shall indicate on the shipping document its compliance with CAN/CGSB-3.14."
              }
            }
          },
          "5_2": {
            "title": "Container filling",
            "subclauses": {
              "5_2_1": {
                "title": "Propane transfers",
                "description": "Propane shall only be transferred from one container to another by a person who is the holder of a certificate recognized by the authority having jurisdiction."
              },
              "5_2_2": {
                "title": "Attending propane transfers",
                "description": "While propane is being transferred from one container to another, the person transferring shall remain at the container being filled."
              },
              "5_2_3": {
                "title": "Container limitations",
                "description": "Propane shall not be put into a) a cylinder, aerosol container, or gas cartridge specifically designed for butane or one that does not conform with the requirements of CSA B340 or CGSB 43.123, respectively; or b) a tank specifically designed for butane or one having a MAWP of less than 250 psig (1.72 MPa)."
              },
              "5_2_4": {
                "title": "Refuelling outlet responsibility",
                "description": "The owner and/or license holder of a container refill centre, card/key lock, or fleet vehicle refuelling outlet shall be held responsible for ensuring compliance with the requirement of Clause 5.2.1."
              },
              "5_2_5": {
                "title": "Anhydrous ammonia",
                "description": "A container having brass equipment designed for propane use shall not be used for anhydrous ammonia. Except as permitted by the requirements of CSA B340, when steel equipment is installed on the container and the container has been used with anhydrous ammonia, it may be used for propane if purged in accordance with Clause A.1."
              },
              "5_2_6": {
                "title": "Container filling",
                "description": "The person filling a container shall be responsible for ensuring that the maximum permitted filling density is not exceeded."
              },
              "5_2_7": {
                "title": "Container filling locations",
                "description": "A container shall not be filled or gauged a) inside a building, other than a building designed for such purpose; b) in a location that is not well ventilated; c) within 10 ft (3 m) measured horizontally from the air intake of any appliance or air-moving equipment; or d) within 10 ft (3 m) measured horizontally from any source of ignition."
              },
              "5_2_8": {
                "title": "Container purging",
                "description": "A new container, or one from which the propane atmosphere has been removed, shall be purged."
              },
              "5_2_9": {
                "title": "Removing liquid contents",
                "description": "When a container is repaired, requalified, or scrapped, its liquid contents shall only be removed by flaring or by transferring to another container."
              },
              "5_2_10": {
                "title": "Purging",
                "description": "Cylinders and motor fuel containers shall be purged in accordance with Clause 6.4.1 of this Code and with CSA B149.5."
              },
              "5_2_11": {
                "title": "Propane-fuelled motor vehicles",
                "description": "A propane-fuelled motor vehicle shall not be refuelled unless a) it is a vehicle identified as meeting the Motor Vehicle Safety Regulations, Standard 301, for factory-equipped vehicles; or b) it meets the requirements of Clause 5.2.1 of CSA B149.5."
              },
              "5_2_12": {
                "title": "Safe purging",
                "description": "Cylinders and motor fuel containers shall not be purged within 10 ft (3 m), measured horizontally, of a) a building, except for a building approved for the purposes; b) a property line; c) a source of ignition; or d) the air intake of any appliance or air-moving equipment."
              }
            }
          },
          "5_3": {
            "title": "Protection of containers and equipment",
            "subclauses": {
              "5_3_1": {
                "title": "Protection against damage",
                "description": "Valves, pressure regulators, gauges, piping, tubing, gas hose, and other equipment shall be protected against damage."
              },
              "5_3_2": {
                "title": "Protection from motor vehicle damage",
                "description": "When containers are installed or stored in locations that do not afford protection from damage from motor vehicles on a street, highway, avenue, alley, or parking lot, they shall be protected by posts or guardrails in compliance with Clause 7.19.4 unless otherwise approved by the authority having jurisdiction."
              },
              "5_3_3": {
                "title": "Readily ignitable materials",
                "description": "Readily ignitable materials, including weeds and long dry grass, shall be removed from the area within 10 ft (3 m) of a container, and this area shall be kept clear of such material at all times."
              },
              "5_3_4": {
                "title": "Plugging service valve outlets",
                "description": "When a distributor-owned container is disconnected by the distributor and left on a customer's property, all container service valve outlets shall be plugged."
              }
            }
          },
          "5_4": {
            "title": "Pressure regulators",
            "subclauses": {
              "5_4_1": {
                "title": "Pressure regulator size",
                "description": "A pressure regulator shall be of sufficient size to provide the required flow rate of propane at the extremes of inlet pressures to which the regulator can be exposed."
              },
              "5_4_2": {
                "title": "Securement and protection of pressure regulators",
                "description": "A pressure regulator shall be firmly secured to the container valve or a regulator bracket on the wall or container dome, or be otherwise secured. When installed outdoors and subject to inclement weather, the pressure regulator shall be protected from exposure to weather conditions."
              },
              "5_4_3": {
                "title": "Regulators installed outdoors",
                "description": "A regulator installed outdoors or in an unheated area shall be positioned so that the bonnet vent opening discharges vertically downward, except that a) when installed within a container dome, the vent opening shall be positioned downward not less than 15° from the horizontal; and b) a single-stage pressure regulator with an input rate not exceeding 150 000 Btuh (44 kW) may be installed in a horizontal position, provided that it is protected from inclement weather."
              }
            }
          }
        }
      },
      "section_6": {
        "title": "Cylinder systems",
        "clauses": {
          "6_1": {
            "title": "Requirements for cylinders",
            "subclauses": {
              "6_1_1": {
                "title": "Refillable cylinders",
                "description": "Refillable cylinders shall be manufactured, tested, inspected, requalified, and marked in accordance with the requirements of CSA B339. Non-refillable cylinders shall either be TC 39M as per Clause 6.1.3 or TC specification 2P, 2Pl, 2P2, 2Q, 2Q2, and 2R as per Clause 6.1.4."
              },
              "6_1_2": {
                "title": "Overfill prevention device",
                "description": "Except for the following, refillable vapour service cylinders manufactured after January 1, 2008, with a capacity of 4 lb (1.8 kg) through 40 lb (18.1 kg) shall be equipped with an overfill prevention device in compliance with UL 2227: a) cylinders used in industrial truck service; and b) cylinders identified and used for industrial welding and cutting gases."
              },
              "6_1_3": {
                "title": "Specification TC 39M",
                "description": "Specification TC 39M non-refillable cylinders shall be manufactured, tested, inspected, and marked in accordance with the requirements of CSA B339."
              },
              "6_1_4": {
                "title": "Specification TC 2P, 2P1, 2P2, ZR, 2Q and 2Q2",
                "description": "TC Specification 2P, 2Pl, 2P2, 2R, 2Q, and 2Q2 non-refillable aerosol containers shall be manufactured, tested, inspected, and marked in accordance with the requirements of CGSB-43.123."
              }
            }
          },
          "6_2": {
            "title": "Liquid-level gauges on cylinders",
            "subclauses": {
              "6_2_1": {
                "title": "Atmospheric bleeding",
                "description": "A liquid level gauge that requires the bleeding of propane to the atmosphere, such as a rotary, fixed-liquid-level, or slip-tube type, shall be designed so that any bleed valve opening is not larger than a No. 54 drill size (1.4 mm) unless it is provided with an excess-flow valve."
              },
              "6_2_2": {
                "title": "Fixed-liquid-level gauge",
                "description": "The length of the dip tube of a fixed-liquid-level gauge shall indicate the maximum level to which a cylinder may be filled."
              },
              "6_2_3": {
                "title": "Fixed-liquid-level gauge marking",
                "description": "When a fixed-liquid-level gauge is used, the length of the dip tube in millimeters, prefixed with the letters 'DT', and followed by the letters 'mm', shall be stamped on the exterior of the valve to which the dip tube is connected and on the cylinder in accordance with CSA B339."
              }
            }
          }
        }
      },
      "section_7": {
        "title": "Tank systems, filling plants, and refill centres",
        "clauses": {
          "7_1": {
            "title": "General",
            "subclauses": {
              "7_1_1": {
                "title": "Tank MAWP",
                "description": "Subject to Clause 5.2.3 b), a tank shall have a MAWP of not less than 250 psig (1.72 MPa) and the tank and its PRD shall be in compliance with CSA B51 and applicable provincial or territorial regulations covering unfired pressure vessels."
              },
              "7_1_2": {
                "title": "Approved tank welding",
                "description": "Welding shall not be done to the shell, head, or any other part of a tank subject to internal pressure, except with the approval and under the supervision of the boiler and pressure vessel inspection authority of the province or territory in which it is installed."
              },
              "7_1_3": {
                "title": "Tank field welding",
                "description": "Field welding of a tank shall be made only on saddle plates or brackets supplied by the manufacturer of the tank."
              },
              "7_1_4": {
                "title": "Tank paint",
                "description": "Every steel tank shall be kept painted."
              },
              "7_1_5": {
                "title": "Tank location",
                "description": "A tank with a capacity in excess of 2000 USWG (7500 L) shall not be installed a) under an electrical transmission line and shall be located a minimum horizontal distance from any such line equal to the property clearance requirements of Clauses 7.10.3 and 7.16; b) under an electrical distribution line and shall be located not less than 25 ft (7.6 m) in any direction from any such line; and c) over an underground electrical distribution line and shall be located not less than 5 ft (1.5 m) from any such line."
              }
            }
          },
          "7_2": {
            "title": "Relief valves",
            "subclauses": {
              "7_2_1": {
                "title": "Approved relief valve",
                "description": "A tank shall be equipped with a properly sized, spring-loaded relief valve that meets the requirements of the provincial or territorial authority where it is to be installed."
              },
              "7_2_2": {
                "title": "Relief valve location on tanks",
                "description": "All relief valves shall have direct communication with the vapour space of tanks."
              },
              "7_2_3": {
                "title": "Relief valve pressure setting adjustment protection",
                "description": "All relief valves shall be so arranged that the possibility of tampering will be minimized. If the pressure setting or adjustment is by external means, the relief valve shall be provided with means for sealing the adjustment."
              },
              "7_2_4": {
                "title": "Shut-off valve or other device location",
                "description": "A shut-off valve or other device shall not be installed between a relief valve and a tank, except a) that a shut-off valve may be used when the full required flow capacity is maintained through another relief valve; or b) an integrated management system from the manufacturer shall be established that controls the operation of the isolation valve that does not inhibit the operation of the PRV while installed."
              },
              "7_2_5": {
                "title": "Relief valve rain cap",
                "description": "A loose-fitting rain cap shall be provided for all tank relief valves."
              }
            }
          }
        }
      },
      "section_8": {
        "title": "Tank trucks, tank trailers, and cargo liners",
        "clauses": {
          "8_1": {
            "title": "General",
            "description": "All tank trucks, tank trailers, and cargo liners shall be designed, fabricated, and marked in accordance with the requirements of CSA B620."
          },
          "8_2": {
            "title": "Electrical equipment and lighting on tank trucks, tank trailers, and cargo liners",
            "subclauses": {
              "8_2_1": {
                "title": "Lighting",
                "description": "A tank truck, tank trailer, or cargo liner shall not be equipped with illumination other than that from an electric source. Lighting circuits shall have overcurrent protection, and the wiring shall have sufficient current-carrying capacity to accommodate the electrical load. The wiring shall be secured, grommetted, and protected against damage."
              },
              "8_2_2": {
                "title": "Electrical equipment",
                "description": "Electric motors, wiring, equipment, and fixtures enclosed in the cabinet shall conform with the provincial or territorial electrical code or the Canadian Electrical Code, Part I, for Class I, Zone 2, Group IIA hazardous locations."
              }
            }
          }
        }
      },
      "section_9": {
        "title": "Vaporizers",
        "clauses": {
          "9_1": {
            "title": "General",
            "subclauses": {
              "9_1_1": {
                "title": "Protection",
                "description": "A vaporizer shall be protected against tampering and damage."
              },
              "9_1_2": {
                "title": "Tank heaters",
                "description": "Vaporizers that are designed to return heated propane to the storage container shall be considered tank heaters."
              },
              "9_1_3": {
                "title": "Building drain",
                "description": "A building used to house a vaporizer shall not have a drain to a sewer or sump pit."
              },
              "9_1_4": {
                "title": "Building requirements",
                "description": "A building or room used for propane vaporizing or mixing shall a) comply with the requirements of Clause 7.17.3, except that the floor of the building shall be built of noncombustible materials; and b) have all pressure relief valve discharges vented to the exterior and shall not terminate within 3 ft (0.9 m) of a ventilation opening unless the relief discharges vertically upward and is above the roof line."
              },
              "9_1_5": {
                "title": "Coil location",
                "description": "Heating or cooling coils shall not be installed inside a container."
              },
              "9_1_6": {
                "title": "Valves",
                "description": "A vaporizer shall have a manually operated valve in each connection to a container."
              },
              "9_1_7": {
                "title": "Maximum pressure",
                "description": "A vaporizer shall not raise the pressure in a container in excess of 215 psig (1.48 MPa)."
              },
              "9_1_8": {
                "title": "Liquid carryover",
                "description": "A vaporizer shall be provided with suitable automatic means to prevent propane in the liquid phase from passing from the vaporizer to the vapour discharge piping."
              },
              "9_1_9": {
                "title": "Source of ignition",
                "description": "An open flame or other source of ignition shall not be permitted in a building housing a vaporizer unless the vaporizer is a direct-fired vaporizer."
              },
              "9_1_10": {
                "title": "Emergency shutdown",
                "description": "An emergency shutdown system shall be installed in any tank system supplying propane to a direct-fired vaporizer. The emergency shutdown system may be of the electrical, pneumatic, or mechanical type or a combination thereof and the means to activate the emergency shutdown system shall be located at least 25 ft (7.6 m) from the direct-fired vaporizer. The emergency shutdown system when activated shall initiate shut-off of the liquid line at the tank location that is connected to the vaporizer."
              }
            }
          },
          "9_2": {
            "title": "Indirect vaporizers",
            "subclauses": {
              "9_2_1": {
                "title": "Pressure vessel registration",
                "description": "An indirect vaporizer classified as a pressure vessel shall be designed, constructed, tested, and marked in accordance with CSA B51 and the regulations of the boiler and pressure vessel inspection authority of the province or territory in which it is installed."
              },
              "9_2_2": {
                "title": "Design working pressure",
                "description": "An indirect vaporizer with an inside diameter of 6 in (150 mm) or less that is exempted from the requirements of CSA B51 shall have a design working pressure of not less than 250 psig (1.72 MPa) and need not be permanently marked."
              }
            }
          },
          "9_3": {
            "title": "Direct-fired vaporizers",
            "subclauses": {
              "9_3_1": {
                "title": "Location restrictions",
                "description": "Subject to Clause 9.3.4, a direct-fired vaporizer shall not be permitted in a pumphouse, a container filling or storage room, or in any other building or room."
              },
              "9_3_2": {
                "title": "Source of ignition",
                "description": "A direct-fired vaporizer is considered a source of ignition and shall be located at a distance in accordance with the requirements of Table 7.4 from any tank or from the fill points of any tank, and at least 25 ft (7.6 m) from a building or property line."
              }
            }
          }
        }
      }
    },
    "annexes": {
      "annex_a": {
        "title": "Purging procedures for propane containers",
        "type": "informative",
        "clauses": {
          "A_1": {
            "title": "Procedure for purging anhydrous ammonia from propane containers",
            "description": "Wear a gas mask approved for ammonia service and suitable protective gloves during the purging procedures. Ensure that other protective and emergency procedures and equipment conform with regulations covering the handling of ammonia."
          },
          "A_2": {
            "title": "Purging flood - Water method",
            "description": "To remove anhydrous ammonia or propane from a tank, the following method may be used: a) Observe all safety precautions relative to the material being purged from the tank. b) After tank pressure has been reduced to atmospheric, open all top valves and remove the relief valves."
          },
          "A_3": {
            "title": "Red litmus paper test for ammonia in propane",
            "description": "This test shall follow the purging of ammonia from tanks: a) The rotary gauge shall be positioned at the 100% mark and opened to allow a moderate stream of vapour to escape."
          },
          "A_4": {
            "title": "Removal of air and moisture from cylinders and motor fuel cylinders",
            "description": "New and reconditioned propane containers and propane containers that have had their interiors exposed to the atmosphere, such as during a valve change, shall be purged of air and moisture."
          }
        }
      },
      "annex_o": {
        "title": "Use of non-refillable propane cylinders in laboratories/classrooms in schools, colleges, and universities",
        "type": "normative",
        "clauses": {
          "O_1": {
            "title": "Scope/general requirements",
            "subclauses": {
              "O_1_1": {
                "title": "Application",
                "description": "These requirements apply to the use of non-refillable propane cylinders in laboratories/classrooms in schools, colleges, and universities."
              },
              "O_1_2": {
                "title": "Scope",
                "description": "Instead of permanently installed gas systems feeding gas outlets for small appliances such as portable Bunsen burners, the appliances may be connected to non-refillable cylinders in accordance with the conditions described below."
              },
              "O_1_3": {
                "title": "Purpose",
                "description": "The appliances and cylinders shall be used for educational and instructional purposes only."
              },
              "O_1_4": {
                "title": "Cylinder certification",
                "description": "Propane cylinders shall be of the approved non-refillable type (TC-39, TC-2P, TC-2Pl, TC-2P2, TC-2Q, TC-2Q2, and TC-2R), commonly referred to as 'single-trip' - with the maximum capacity of 16 oz."
              }
            }
          },
          "O_2": {
            "title": "Classroom quantities",
            "subclauses": {
              "O_2_1": {
                "title": "Maximum in the room",
                "description": "No more than the quantity of cylinders required to fuel the appliance shall be brought into the laboratory/classroom."
              },
              "O_2_2": {
                "title": "Maximum connected for use",
                "description": "Not more than 20 cylinders may be connected for use in a laboratory/classroom at one time or one cylinder to every two students, whichever number is lower."
              }
            }
          }
        }
      },
      "annex_q": {
        "title": "Temporary use of cylinders at shows, exhibitions, or other similar events",
        "type": "normative",
        "clauses": {
          "Q_1": {
            "title": "Marking",
            "description": "A cylinder shall be labelled 'Propane', 'Liquid Petroleum (LP) Gas', or 'Danger: flammable gas'. This label shall be easily readable and affixed in a conspicuous location."
          },
          "Q_2": {
            "title": "Maximum capacity",
            "description": "A cylinder containing a maximum of 20 lb (9 kg) of propane and not connected to any other cylinder may be used indoors to supply propane to an appliance. The total propane capacity of cylinders installed indoors shall not exceed 1 lb (0.5 kg) per 200 ft² (18 m²) of floor area."
          },
          "Q_3": {
            "title": "Location",
            "description": "A cylinder in use within a building shall not be located within 50 ft (15 m) of an exit or stairway."
          }
        }
      }
    },
    "tables": {
      "table_5_1": {
        "title": "Mechanical ventilation flow rate in buildings",
        "reference": "See Clause 5.11.3",
        "description": "Continuous mechanical ventilation flow rates based on vehicle operating time in hours, with flow rates in cfm per brake horsepower."
      },
      "table_6_1": {
        "title": "Maximum permitted filling density of a cylinder by weight",
        "reference": "See Clause 6.4.2",
        "description": "Shows water weight capacity percentages for propane (42%) and butane (51%) based on relative density at 59°F (15°C)."
      },
      "table_6_3": {
        "title": "Cylinder storage clearances",
        "reference": "See Clauses 6.5.1.8, 6.5.2.6.1, and 6.5.3.2",
        "description": "Minimum distances from cylinder storage to buildings, property lines, and public areas based on quantity of propane stored."
      },
      "table_7_4": {
        "title": "Location of above-ground tanks for consumer applications",
        "reference": "See Clauses 7.10.2, 7.10.3, and 9.3.2 and Annex M",
        "description": "Minimum distances between tanks and various structures based on total aggregate water capacity in USWG."
      },
      "table_7_6": {
        "title": "Electrical classification",
        "reference": "See Clauses 6.5.1.11, 6.5.1.12, 6.5.2.6.1, 7.13, 7.19.5, and 8.8.1",
        "description": "Hazardous location classifications for various propane storage and handling scenarios, including extent of hazardous locations and Group IIA classifications."
      }
    }
  }
};

// Create searchable index for CSA B149.2
export const createCSASearchIndex = () => {
  const searchIndex = [];
  
  if (!csaB149Data.document) return searchIndex;
  
  // Index main document
  searchIndex.push({
    id: 'csa-b149-2-main',
    clause: 'Main',
    title: csaB149Data.document.title,
    description: 'CSA B149.2:25 Propane storage and handling code - Canadian Standards Association',
    category: 'document',
    type: 'document'
  });
  
  // Index sections
  if (csaB149Data.document.sections) {
    Object.entries(csaB149Data.document.sections).forEach(([sectionKey, section]) => {
      // Index section
      searchIndex.push({
        id: `section-${sectionKey}`,
        clause: sectionKey.replace('section_', ''),
        title: section.title,
        description: `Section covering ${section.title.toLowerCase()}`,
        category: 'section',
        type: 'section'
      });
      
      // Index clauses within sections
      if (section.clauses) {
        Object.entries(section.clauses).forEach(([clauseKey, clause]) => {
          let clauseTitle = '';
          let clauseDescription = '';
          
          if (typeof clause === 'object' && clause.title) {
            clauseTitle = clause.title;
            clauseDescription = clause.description || '';
          } else if (typeof clause === 'string') {
            clauseTitle = clauseKey;
            clauseDescription = clause;
          } else {
            clauseTitle = clauseKey;
            clauseDescription = '';
          }
          
          searchIndex.push({
            id: `${sectionKey}-${clauseKey}`,
            clause: `${sectionKey.replace('section_', '')}.${clauseKey}`,
            title: clauseTitle,
            description: clauseDescription,
            category: section.title,
            type: 'clause'
          });
          
          // Index subclauses if they exist
          if (typeof clause === 'object' && clause.subclauses) {
            Object.entries(clause.subclauses).forEach(([subKey, subclause]) => {
              let subTitle = '';
              let subDescription = '';
              
              if (typeof subclause === 'object' && subclause.title) {
                subTitle = subclause.title;
                subDescription = subclause.description || '';
              } else if (typeof subclause === 'string') {
                subTitle = subKey;
                subDescription = subclause;
              }
              
              searchIndex.push({
                id: `${sectionKey}-${clauseKey}-${subKey}`,
                clause: `${sectionKey.replace('section_', '')}.${clauseKey}.${subKey}`,
                title: subTitle,
                description: subDescription,
                category: section.title,
                type: 'subclause'
              });
            });
          }
        });
      }
    });
  }
  
  // Index annexes
  if (csaB149Data.document.annexes) {
    Object.entries(csaB149Data.document.annexes).forEach(([annexKey, annex]) => {
      searchIndex.push({
        id: `annex-${annexKey}`,
        clause: `Annex ${annexKey.replace('annex_', '').toUpperCase()}`,
        title: annex.title,
        description: `${annex.type} annex covering ${annex.title.toLowerCase()}`,
        category: 'annex',
        type: 'annex'
      });
      
      // Index annex clauses
      if (annex.clauses) {
        Object.entries(annex.clauses).forEach(([clauseKey, clause]) => {
          let clauseTitle = '';
          let clauseDescription = '';
          
          if (typeof clause === 'object' && clause.title) {
            clauseTitle = clause.title;
            clauseDescription = clause.description || '';
          } else if (typeof clause === 'string') {
            clauseTitle = clauseKey;
            clauseDescription = clause;
          }
          
          searchIndex.push({
            id: `${annexKey}-${clauseKey}`,
            clause: `Annex ${annexKey.replace('annex_', '').toUpperCase()}.${clauseKey}`,
            title: clauseTitle,
            description: clauseDescription,
            category: annex.title,
            type: 'annex-clause'
          });
          
          // Index annex subclauses
          if (typeof clause === 'object' && clause.subclauses) {
            Object.entries(clause.subclauses).forEach(([subKey, subclause]) => {
              let subTitle = '';
              let subDescription = '';
              
              if (typeof subclause === 'object' && subclause.title) {
                subTitle = subclause.title;
                subDescription = subclause.description || '';
              } else if (typeof subclause === 'string') {
                subTitle = subKey;
                subDescription = subclause;
              }
              
              searchIndex.push({
                id: `${annexKey}-${clauseKey}-${subKey}`,
                clause: `Annex ${annexKey.replace('annex_', '').toUpperCase()}.${clauseKey}.${subKey}`,
                title: subTitle,
                description: subDescription,
                category: annex.title,
                type: 'annex-subclause'
              });
            });
          }
        });
      }
    });
  }
  
  // Index tables
  if (csaB149Data.document.tables) {
    Object.entries(csaB149Data.document.tables).forEach(([tableKey, table]) => {
      searchIndex.push({
        id: `table-${tableKey}`,
        clause: tableKey.replace('table_', 'Table '),
        title: table.title,
        description: `${table.description} Reference: ${table.reference}`,
        category: 'table',
        type: 'table'
      });
    });
  }
  
  return searchIndex;
};

// Normalize search terms to handle hyphenated words
const normalizeSearchTerm = (text) => {
  return text.toLowerCase().replace(/-/g, ' ');
};

// Search function for CSA B149.2
export const searchCSACode = (query, searchIndex = null) => {
  if (!query || query.trim().length < 2) return [];

  const index = searchIndex || createCSASearchIndex();
  const searchTerm = query.toLowerCase().trim();
  const normalizedSearchTerm = normalizeSearchTerm(searchTerm);

  return index.filter(item => {
    const normalizedTitle = normalizeSearchTerm(item.title);
    const normalizedDescription = normalizeSearchTerm(item.description);
    const normalizedCategory = normalizeSearchTerm(item.category);

    return (
      item.title.toLowerCase().includes(searchTerm) ||
      normalizedTitle.includes(normalizedSearchTerm) ||
      item.description.toLowerCase().includes(searchTerm) ||
      normalizedDescription.includes(normalizedSearchTerm) ||
      item.clause.toLowerCase().includes(searchTerm) ||
      item.category.toLowerCase().includes(searchTerm) ||
      normalizedCategory.includes(normalizedSearchTerm)
    );
  }).slice(0, 50); // Limit results to 50
};

// Get section by key
export const getSectionByKey = (sectionKey) => {
  return csaB149Data.document?.sections?.[sectionKey] || null;
};

// Get clause by section and clause key
export const getClause = (sectionKey, clauseKey) => {
  const section = getSectionByKey(sectionKey);
  return section?.clauses?.[clauseKey] || null;
};

// Get all definitions (from section 3 if it exists)
export const getAllDefinitions = () => {
  return csaB149Data.document?.sections?.section_3?.clauses || {};
};

// Search within specific section
export const searchInSection = (query, sectionKey) => {
  const section = getSectionByKey(sectionKey);
  if (!section) return [];

  const searchTerm = query.toLowerCase().trim();
  const normalizedSearchTerm = normalizeSearchTerm(searchTerm);
  const results = [];

  if (section.clauses) {
    Object.entries(section.clauses).forEach(([key, clause]) => {
      let clauseText = '';
      let normalizedClauseText = '';

      if (typeof clause === 'object') {
        clauseText = `${clause.title || ''} ${clause.description || ''}`.toLowerCase();
        normalizedClauseText = normalizeSearchTerm(clauseText);
      } else {
        clauseText = `${key} ${clause}`.toLowerCase();
        normalizedClauseText = normalizeSearchTerm(clauseText);
      }

      if (clauseText.includes(searchTerm) || normalizedClauseText.includes(normalizedSearchTerm)) {
        results.push({
          id: `${sectionKey}-${key}`,
          clause: `${sectionKey.replace('section_', '')}.${key}`,
          title: (typeof clause === 'object' ? clause.title : key) || key,
          description: typeof clause === 'object' ? clause.description || '' : clause,
          category: section.title,
          type: 'clause'
        });
      }
    });
  }
  
  return results;
};

// Get popular search terms for CSA B149.2
export const getPopularSearchTerms = () => {
  return [
    'container', 'cylinder', 'tank', 'appliance', 'valve', 'regulator', 
    'filling', 'vaporizer', 'relief', 'pressure', 'safety', 'installation',
    'propane', 'burner', 'fitting', 'piping', 'ventilation', 'clearance'
  ];
};

// Export default
export default csaB149Data;