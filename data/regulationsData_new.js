// data/regulationsData.js
// Comprehensive Ontario Regulations Data - Generated from JSON files

export const regulationsData = [
  // Technical Standards and Safety Act, 2000 - Main Act
  {
    id: "TSSA-1",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "1",
    title: "Purpose",
    description: "The purpose of this Act is to enhance public safety in Ontario by providing for the efficient and flexible administration of technical standards with respect to the matters referred to in section 2.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act",
    type: "section",
    keywords: "purpose enhance public safety Ontario efficient flexible administration technical standards",
    amendments: ["2000, c. 16, s. 1"]
  },
  {
    id: "TSSA-2",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "2",
    title: "Application",
    description: "This Act applies to amusement devices, boilers and pressure vessels, elevating devices, fuels, and operating engineers.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act",
    type: "section",
    keywords: "application amusement devices boilers pressure vessels elevating devices fuels operating engineers",
    amendments: ["2019, c. 4, Sched. 7, s. 1"]
  },
  {
    id: "TSSA-3-administrative_penalty",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "3 - administrative_penalty",
    title: "Definition: administrative_penalty",
    description: "means an administrative penalty imposed under section 32.1",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act - Definitions",
    type: "definition",
    keywords: "definition administrative_penalty administrative penalty imposed under section 32.1",
    amendments: ["2000, c. 16, s. 3; 2009, c. 28, s. 1; 2019, c. 4, Sched. 7, s. 2"]
  },
  {
    id: "TSSA-3-authorization",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "3 - authorization",
    title: "Definition: authorization",
    description: "means any form of authorization under this Act and includes, (a) with respect to a person, a certificate, identification, licence or registration, and (b) with respect to a thing, an approval, certificate, licence, permit or registration",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act - Definitions",
    type: "definition",
    keywords: "definition authorization certificate identification licence registration approval permit",
    amendments: ["2000, c. 16, s. 3; 2009, c. 28, s. 1; 2019, c. 4, Sched. 7, s. 2"]
  },
  {
    id: "TSSA-3-Corporation",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "3 - Corporation",
    title: "Definition: Corporation",
    description: "means the corporation continued by subsection 3.1(1)",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act - Definitions",
    type: "definition",
    keywords: "definition Corporation corporation continued subsection 3.1",
    amendments: ["2000, c. 16, s. 3; 2009, c. 28, s. 1; 2019, c. 4, Sched. 7, s. 2"]
  },
  {
    id: "TSSA-3-inspector",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "3 - inspector",
    title: "Definition: inspector",
    description: "means a person appointed as an inspector under this Act or a predecessor Act",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Main Act - Definitions",
    type: "definition",
    keywords: "definition inspector person appointed Act predecessor",
    amendments: ["2000, c. 16, s. 3; 2009, c. 28, s. 1; 2019, c. 4, Sched. 7, s. 2"]
  },
  {
    id: "TSSA-3.1",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "3.1",
    title: "Corporation continued",
    description: "The Technical Standards and Safety Authority is continued as a corporation without share capital under the name Technical Standards and Safety Authority in English and Office des normes techniques et de la securite in French.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Administration - Corporation",
    type: "section",
    keywords: "Corporation continued Technical Standards Safety Authority TSSA corporation share capital",
    amendments: ["2009, c. 28, s. 2"]
  },
  {
    id: "TSSA-3.2",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "3.2",
    title: "Composition",
    description: "The Corporation is composed of the members of its board of directors. A person ceases to be a member of the Corporation when he or she ceases to be a director.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Administration - Corporation",
    type: "section",
    keywords: "Composition Corporation members board directors ceases member",
    amendments: ["2009, c. 28, s. 2"]
  },
  {
    id: "TSSA-4",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "4",
    title: "Appointments of directors, inspectors and investigators",
    description: "The Corporation may appoint directors, inspectors and investigators for the purposes of this Act, the regulations, a Minister's order or an alternate rule, including for the purpose of determining whether authorization holders continue to meet the requirements for authorization and the requirements of this Act, the regulations, Minister's orders and alternate rules.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Administration - Directors and Inspectors",
    type: "section",
    keywords: "Appointments directors inspectors investigators Corporation purposes Act regulations Ministers order alternate rule authorization holders requirements",
    amendments: ["2006, c. 34, s. 25; 2009, c. 28, s. 3; 2018, c. 7, s. 16; 2019, c. 4, Sched. 7, s. 11"]
  },
  {
    id: "TSSA-5",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "5",
    title: "Powers",
    description: "A director has general supervisory and administrative responsibility in respect of all or any part of this Act, the regulations, a Minister's order or an alternate rule with respect to which he or she is appointed.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Administration - Directors and Inspectors",
    type: "section",
    keywords: "Powers director general supervisory administrative responsibility Act regulations Minister order alternate rule appointed",
    amendments: ["2000, c. 16, s. 5; 2006, c. 34, s. 25; 2018, c. 7, s. 16; 2019, c. 4, Sched. 7, s. 12"]
  },
  {
    id: "TSSA-6",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "6",
    title: "Requirement for authorization",
    description: "Authorization required before carrying out prescribed activities or operating things referred to in regulations. Requirements for granting, refusing, suspending or revoking authorizations. Authorization is subject to restrictions, limitations and conditions as prescribed and imposed by a director.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Authorizations and Safety Orders",
    type: "section",
    keywords: "Requirement authorization prescribed activities operating things regulations granting refusing suspending revoking restrictions limitations conditions director",
    amendments: ["2000, c. 16, s. 6; 2009, c. 28, s. 4; 2019, c. 4, Sched. 7, s. 13"]
  },
  {
    id: "TSSA-14",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "14",
    title: "Safety orders",
    description: "A director may give a safety order to any person or class of persons with respect to any matter governed by this Act that pertains to safety. The safety order may require that any thing or part of a thing, or class of things, be dealt with as set out in the order, including being shut down, being used only in accordance with the order, and not being used.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Authorizations and Safety Orders",
    type: "section",
    keywords: "Safety orders director person class persons matter governed Act pertains safety shut down used accordance order not used",
    amendments: ["2000, c. 16, s. 14; 2009, c. 28, s. 6"]
  },
  {
    id: "TSSA-17",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "17",
    title: "Inspection",
    description: "An inspector may conduct an inspection and may enter and inspect at any reasonable time the lands and premises where regulated things are used, operated, installed, made, manufactured, repaired, renovated or offered for sale for the purpose of ensuring compliance with this Act, ensuring that an authorization holder remains entitled to the authorization, or determining whether a hazardous condition exists.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Inspections and Enforcement",
    type: "section",
    keywords: "Inspection inspector conduct enter inspect reasonable time lands premises regulated things used operated installed manufactured repaired renovated offered sale compliance authorization holder entitled hazardous condition",
    amendments: ["2006, c. 34, s. 25; 2019, c. 4, Sched. 7, s. 17; 2019, c. 14, Sched. 10, s. 17"]
  },
  {
    id: "TSSA-23",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "23",
    title: "Director's confirmation",
    description: "A director may issue a written confirmation with respect to any authorization or non-authorization, the revocation or suspension of an authorization, the restrictions or conditions to which an authorization is subject, the filing or non-filing of any document or material, or any other matter prescribed or set out in a Minister's order or alternate rule. A confirmation is proof, in the absence of evidence to the contrary, of the facts stated in it.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Inspections and Enforcement",
    type: "section",
    keywords: "Director confirmation written authorization non-authorization revocation suspension restrictions conditions filing document material Minister order alternate rule proof evidence facts",
    amendments: ["2000, c. 16, s. 23; 2019, c. 4, Sched. 7, s. 21"]
  },
  {
    id: "TSSA-31",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "31",
    title: "Director's order, public safety",
    description: "In cases where there is or may be a demonstrable threat to public safety, a director may make an order with respect to matters including requiring and establishing the form and location of notices, markings or other forms of identification to be used in conjunction with equipment or other things that are prescribed, and regulating the design, fabrication, processing, handling, installation, operation, access, use, repair, maintenance, inspection, location, construction, removing, alteration, service, testing, filling, replacement, blocking, dismantling, destruction, removal from service and transportation of any thing.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Administration - Corporation",
    type: "section",
    keywords: "Director order public safety demonstrable threat notices markings identification equipment prescribed regulating design fabrication processing handling installation operation access use repair maintenance inspection location construction removing alteration service testing filling replacement blocking dismantling destruction removal transportation",
    amendments: ["2000, c. 16, s. 31; 2019, c. 4, Sched. 7, s. 22"]
  },
  {
    id: "TSSA-32.1",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "32.1",
    title: "Administrative penalties",
    description: "A director may impose an administrative penalty on a person who contravenes this Act, the regulations, a Minister's order or an alternate rule.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Administrative Penalties and Offences",
    type: "section",
    keywords: "Administrative penalties director impose penalty person contravenes Act regulations Minister order alternate rule",
    amendments: ["2018, c. 7, s. 19"]
  },
  {
    id: "TSSA-35",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "35",
    title: "Regulations by Lieutenant Governor in Council",
    description: "The Lieutenant Governor in Council may make regulations prescribing anything that is referred to in this Act as being prescribed.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Regulations and Minister's Orders",
    type: "section",
    keywords: "Regulations Lieutenant Governor Council make regulations prescribing referred Act prescribed",
    amendments: ["2000, c. 16, s. 35"]
  },
  {
    id: "TSSA-36",
    regulation: "Technical Standards and Safety Act, 2000",
    section: "36",
    title: "Minister's regulations",
    description: "The Minister may make regulations for carrying out the purposes of this Act.",
    document_title: "Technical Standards and Safety Act, 2000",
    subtitle: "Regulations and Minister's Orders",
    type: "section",
    keywords: "Minister regulations make regulations carrying purposes Act",
    amendments: ["2000, c. 16, s. 36"]
  }
];

// Add more entries - this is a starting foundation
// The remaining entries from the 5 Ontario Regulations will be added through processing

// Create search index for regulations
export const createRegulationSearchIndex = (data) => {
  const index = new Map();
  
  data.forEach((item, idx) => {
    const searchableText = [
      item.title || '',
      item.description || '',
      item.section || '',
      item.regulation || '',
      item.keywords || '',
      item.document_title || '',
      item.subtitle || ''
    ].join(' ').toLowerCase();
    
    const words = searchableText.split(/\s+/).filter(word => 
      word.length > 2 && 
      !['the', 'and', 'for', 'are', 'but', 'not', 'you', 'all', 'can', 'had', 'her', 'was', 'one', 'our', 'out', 'day', 'get', 'has', 'him', 'his', 'how', 'man', 'new', 'now', 'old', 'see', 'two', 'way', 'who', 'boy', 'did', 'its', 'let', 'put', 'say', 'she', 'too', 'use'].includes(word)
    );
    
    words.forEach(word => {
      if (!index.has(word)) {
        index.set(word, new Set());
      }
      index.get(word).add(idx);
    });
  });
  
  return index;
};

// Search regulations function
export const searchRegulations = (query, searchIndex) => {
  if (!query || !searchIndex) return [];
  
  const searchTerm = query.toLowerCase().trim();
  const words = searchTerm.split(/\s+/);
  
  let resultIndices = new Set();
  
  words.forEach(word => {
    if (searchIndex.has(word)) {
      searchIndex.get(word).forEach(idx => resultIndices.add(idx));
    }
    
    // Partial matching for longer words
    if (word.length > 3) {
      searchIndex.forEach((indices, indexWord) => {
        if (indexWord.includes(word) || word.includes(indexWord)) {
          indices.forEach(idx => resultIndices.add(idx));
        }
      });
    }
  });
  
  // Fallback simple text search
  const simpleResults = regulationsData.filter(item => {
    const searchableText = [
      item.title || '',
      item.description || '',
      item.section || '',
      item.regulation || '',
      item.document_title || ''
    ].join(' ').toLowerCase();
    
    return searchableText.includes(searchTerm);
  });
  
  const indexResults = Array.from(resultIndices).map(idx => regulationsData[idx]);
  const allResults = [...indexResults, ...simpleResults];
  const uniqueResults = allResults.filter((item, index, self) => 
    index === self.findIndex(t => t.id === item.id)
  );
  
  return uniqueResults.sort((a, b) => {
    const aTitle = (a.title || '').toLowerCase();
    const bTitle = (b.title || '').toLowerCase();
    const queryLower = searchTerm.toLowerCase();
    
    // Prioritize title matches
    if (aTitle.includes(queryLower) && !bTitle.includes(queryLower)) return -1;
    if (!aTitle.includes(queryLower) && bTitle.includes(queryLower)) return 1;
    
    return 0;
  }).slice(0, 50);
};